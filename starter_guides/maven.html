<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2018-04-10 
 | Rendered using Apache Maven Fluido Skin 1.4
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="Yiannis Paschalidis" />
    <meta name="Date-Revision-yyyymmdd" content="20180322" />
    <meta http-equiv="Content-Language" content="en" />
    <title>bLight &#x2013; Maven integration</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-1.4.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />

      
    <script type="text/javascript" src="../js/apache-maven-fluido-1.4.min.js"></script>

    
                  </head>
        <body class="topBarDisabled">
          
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>bLight parent</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
            
                
                    
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">Main</li>
                              
      <li>
  
                          <a href="../index.html" title="Introduction">
          <span class="none"></span>
        Introduction</a>
            </li>
                
      <li>
  
                          <a href="https://github.com/yiannis-p/bLight/" class="externalLink" title="Download">
          <span class="none"></span>
        Download</a>
            </li>
                              <li class="nav-header">Getting started</li>
                              
      <li class="active">
  
            <a href="#"><span class="none"></span>Maven projects</a>
          </li>
                
      <li>
  
                          <a href="../starter_guides/ant.html" title="Ant builds">
          <span class="none"></span>
        Ant builds</a>
            </li>
                
      <li>
  
                          <a href="../starter_guides/command_line.html" title="Command-line">
          <span class="none"></span>
        Command-line</a>
            </li>
                              <li class="nav-header">User documentation</li>
                              
      <li>
  
                          <a href="../user_guide.html" title="User guide">
          <span class="none"></span>
        User guide</a>
            </li>
                
      <li>
  
                          <a href="../javadoc/index.html" title="API docs">
          <span class="none"></span>
        API docs</a>
            </li>
                
      <li>
  
                          <a href="../examples.html" title="Examples">
          <span class="none"></span>
        Examples</a>
            </li>
                
      <li>
  
                          <a href="../maven_plugin_ref.html" title="Maven plugin">
          <span class="none"></span>
        Maven plugin</a>
            </li>
                
      <li>
  
                          <a href="../ant_task_ref.html" title="Ant task">
          <span class="none"></span>
        Ant task</a>
            </li>
                
      <li>
  
                          <a href="../commandline_ref.html" title="Command-line tool">
          <span class="none"></span>
        Command-line tool</a>
            </li>
                
      <li>
  
                          <a href="../faq.html" title="FAQ">
          <span class="none"></span>
        FAQ</a>
            </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                                                                                                                                                    
      <li>
  
                          <a href="../project-info.html" title="Project Information">
          <span class="icon-chevron-right"></span>
        Project Information</a>
                  </li>
            </ul>
                
                    
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="../images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span10" >
                                  
            

  

    <!-- Section uses an H2, so use H3 and below for sub-sections. -->
    <div class="section">
<h2><a name="Getting_started_-_Maven"></a>Getting started - Maven</h2>


<p>This guide shows how to get a simple &quot;Hello World&quot; bLight application
up and running using Apache Maven. For simplicity, this example is a 
command-line application which runs and template and then exits. It is
not an example of good practice, as it omits nicities such as error handling,
logging and unit testing. The complete source code and configuration discussed 
here can be downloaded together in a single 
<a href="../blight-example-maven-helloworld-src.zip">zip file</a>.</p>


<p>Templates should be placed together with your other Java code under
<tt>src/main/java</tt>. It is recommended that templates are placed in 
their own package. In the example, the application consists of the 
main <tt>MyApp</tt> application class, and a single template
named <tt>MyTemplate</tt>. The <tt>pom.xml</tt> is a standard
Maven POM.</p>
 

<div class="source"><pre class="prettyprint">
/
|-- pom.xml
`-- src/
    `-- main/java/example/mycompany/myapp/
        |-- MyApp.java
        `-- templates/
            `-- MyTemplate.java
</pre></div>


<div class="section">
<h3><a name="Java_code"></a>Java code</h3>


<p>The bLight Java API is quite small. There are only two classes which you need to be familiar
with - <tt>AbstractTemplate</tt> which is the default parent class for all templates, and  
the <tt>TemplateManager</tt> which executes templates.</p>


<div class="section">
<h4><a name="MyApp.java"></a>MyApp.java</h4>


<p>The application code creates a template, sets the output to System.out and executes the template.
<i>Note</i>: While it is possible to execute templates directly, it is recommended to always use
the TemplateManager. This allows for dynamic template compilation (see below) during development 
without requiring an application restart each time a template is changed.</p>


<div class="source"><pre class="prettyprint">
package example.mycompany.myapp;

import java.io.IOException;
import java.io.PrintWriter;

import com.aleax.blight.TemplateException;
import com.aleax.blight.TemplateManager;

import example.mycompany.myapp.templates.MyTemplate;

public class MyApp
{
    public static void main(final String[] args) throws TemplateException, IOException
    {
        // Create a new template
        MyTemplate template = new MyTemplate();
        
        // Configure the template to send its output to System.out
        PrintWriter out = new PrintWriter(System.out);
        template.setOutput(out);

        // Compile and execute the template
        TemplateManager.execute(template);

        // Ensure the output is written before the app terminates
        out.flush();
    }
}
</pre></div>

</div>
<div class="section">
<h4><a name="MyTemplate.java"></a>MyTemplate.java</h4>


<p>The template extends AbstractTemplate and must implement the <tt>execute()</tt> method.
Any comments within this method are written to the template output when the method is called
on the compiled template. The example template also contains a single setter to pass in the 
customer details to include in the template output.</p>


<div class="source"><pre class="prettyprint">
package example.mycompany.myapp.templates;

import java.io.IOException;
import com.aleax.blight.AbstractTemplate;

public class MyTemplate extends AbstractTemplate
{
    @Override
    public void execute() throws IOException
    {
        /*Hello World!*/
    }
}
</pre></div>

</div></div>
<div class="section">
<h3><a name="Maven_build_configuration"></a>Maven build configuration</h3>


<div class="section">
<h4><a name="Dependencies"></a>Dependencies</h4>


<p>For basic use, bLight only requires a single Maven dependency at runtime. 
Add the following dependency to your project's dependencies.</p>


<div class="source"><pre class="prettyprint">
&lt;!-- Core bLight dependency required for both testing and deployment --&gt;
&lt;dependency&gt;
   &lt;groupId&gt;com.aleax&lt;/groupId&gt;
   &lt;artifactId&gt;blight-core&lt;/artifactId&gt;
   &lt;version&gt;1.0.0&lt;/version&gt;
&lt;/dependency&gt;
</pre></div>

</div>
<div class="section">
<h4><a name="Build_plugin"></a>Build plugin</h4>


<p>bLight templates must be compiled before they can be used. For a production
deployment, they should be pre-compiled using the bLight Maven plugin. Add the
plugin below to your project's build plugins. By default, the plugin is executed 
in Maven's process-classes phase, after the main application classes have been 
compiled.</p>


<div class="source"><pre class="prettyprint">
&lt;!-- Always precompile bLight templates during a build --&gt;
&lt;plugin&gt;
   &lt;groupId&gt;com.aleax&lt;/groupId&gt;
   &lt;artifactId&gt;blight-maven-plugin&lt;/artifactId&gt;
   &lt;version&gt;1.0.0&lt;/version&gt;
   &lt;configuration&gt;
      &lt;packageNames&gt;
         &lt;!-- Replace this with a list of the packages from your app --&gt;
         &lt;param&gt;example.mycompany.myapp.packages&lt;/param&gt;
      &lt;/packageNames&gt;
   &lt;/configuration&gt;
   &lt;executions&gt;
      &lt;execution&gt;
         &lt;goals&gt;
            &lt;goal&gt;compileTemplates&lt;/goal&gt;
         &lt;/goals&gt;
      &lt;/execution&gt;
   &lt;/executions&gt;
&lt;/plugin&gt;
</pre></div>

</div></div>
<div class="section">
<h3><a name="Enabling_dynamic_template_compilation"></a>Enabling dynamic template compilation</h3>


<p>Templates can be compiled at run-time for faster development without requiring an application 
restart after each change. To enable this functionality, the blight-compiler and template java
sources must be added to the classpath, and the templates must not be pre-compiled until the
application is packaged.</p>


<p>You will need to add the bLight compiler to your application dependencies. The scope should be set to
either <tt>test</tt> or <tt>provided</tt> to avoid the dependency being added to the packaged 
application. Use scope &quot;test&quot; if you will only be running tests, or &quot;provided&quot; for running both tests 
and the main application from within your IDE.</p>


<div class="source"><pre class="prettyprint">
&lt;!-- For on-demand bLight template compilation when running the app in an IDE. --&gt;
&lt;dependency&gt;
   &lt;groupId&gt;com.aleax&lt;/groupId&gt;
   &lt;artifactId&gt;blight-compiler&lt;/artifactId&gt;
   &lt;version&gt;1.0.0&lt;/version&gt;
   &lt;!-- Use scope &quot;provided&quot; or &quot;test&quot; only. --&gt;
   &lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;
</pre></div>


<p>Two changes are required in the Maven POM. In the build plugins, the template java source must be
added to the classpath so that it can be compiled at run-time. The blight-maven-plugin is also changed
to run in the prepare-package phase, as we don't want the templates to be pre-compiled when developing/testing
the application.</p>


<div class="source"><pre class="prettyprint">
&lt;!-- 
The .java template sources must be added to the classpath to allow 
on-demand compilation when running the application in an IDE. 
--&gt;
&lt;plugin&gt;
    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
    &lt;artifactId&gt;maven-resources-plugin&lt;/artifactId&gt;
    &lt;version&gt;2.6&lt;/version&gt;
    &lt;executions&gt;
      &lt;execution&gt;
        &lt;id&gt;additional-resources&lt;/id&gt;
        &lt;phase&gt;process-test-resources&lt;/phase&gt;
        &lt;goals&gt;
          &lt;goal&gt;copy-resources&lt;/goal&gt;
        &lt;/goals&gt;
        &lt;configuration&gt;
          &lt;!-- 
          The templates are copied to the test output directory as we only need on-demand compilation for testing.
          This also ensures that the sources are not accidentally included in the deployable artefacts. 
          --&gt;
          &lt;outputDirectory&gt;${project.build.testOutputDirectory}/com/aleax/blight/example/webapp/templates&lt;/outputDirectory&gt;
          &lt;resources&gt;
            &lt;resource&gt;
              &lt;directory&gt;${project.basedir}/src/main/java/com/aleax/blight/example/webapp/templates&lt;/directory&gt;
            &lt;/resource&gt;
          &lt;/resources&gt;
        &lt;/configuration&gt;
      &lt;/execution&gt;
    &lt;/executions&gt;
&lt;/plugin&gt;

&lt;!-- 
Pre-compile the templates only when packaging up the application.
Changes made in an IDE will not be picked up if templates are pre-compiled.
 --&gt;
&lt;plugin&gt;
   &lt;groupId&gt;com.aleax&lt;/groupId&gt;
   &lt;artifactId&gt;blight-maven-plugin&lt;/artifactId&gt;
   &lt;version&gt;${project.version}&lt;/version&gt;
   &lt;configuration&gt;
      &lt;packageNames&gt;
         &lt;param&gt;com.aleax.blight.example.webapp.templates&lt;/param&gt;
      &lt;/packageNames&gt;
   &lt;/configuration&gt;
   &lt;executions&gt;
      &lt;execution&gt;
         &lt;!-- This is the key change --&gt;
         &lt;phase&gt;prepare-package&lt;/phase&gt;
         &lt;goals&gt;
            &lt;goal&gt;compileTemplates&lt;/goal&gt;
         &lt;/goals&gt;
      &lt;/execution&gt;
   &lt;/executions&gt;
&lt;/plugin&gt;
</pre></div>

    </div></div>

  


                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                                      <p >Copyright &copy;                   2018.
          All rights reserved.      
                    
                  <li id="publishDate" class="pull-right">Last Published: 2018-04-10</li>
              <li id="projectVersion" class="pull-right">
                    Version: 1.0.0
        </li>
            </p>
                </div>

        
                </div>
    </footer>
        </body>
</html>
